This is the Python version, which definitely has some questionable code. (We use files as databases and read them in full every time we need to update them, for one.)